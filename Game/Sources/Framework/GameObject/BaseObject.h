#pragma once

class BaseObject : public std::enable_shared_from_this<BaseObject>
{
public:
	BaseObject(){}
	virtual ~BaseObject(){}

	virtual void Init(){}

	virtual void PreUpdate(){}
	virtual void Update(){}
	virtual void PostUpdate(){}

	virtual void PreDraw(){}
	virtual void DrawShadow(){}
	virtual void Draw(){}
	virtual void DrawSprite(){}

	virtual void ImGuiUpdate(){}

	// 回転設定
	virtual void SetRotationX(float rotX)
	{ m_mWorld *= Math::Matrix::CreateRotationX(DirectX::XMConvertToRadians(rotX)); }

	virtual void SetRotationY(float rotY)
	{ m_mWorld *= Math::Matrix::CreateRotationY(DirectX::XMConvertToRadians(rotY)); }

	virtual void SetRotationZ(float rotZ)
	{ m_mWorld *= Math::Matrix::CreateRotationZ(DirectX::XMConvertToRadians(rotZ)); }
	
	// スケール設定
	virtual void SetScale(float scale)
	{ m_mWorld *= Math::Matrix::CreateScale(scale); }
	
	// 座標設定
	virtual void SetPos(const Math::Vector3& pos)
	{ m_mWorld.Translation(pos); }

	// 座標取得
	inline virtual Math::Vector3 GetPos() const 
	{ return m_mWorld.Translation(); }

	// 行列取得
	inline const Math::Matrix& GetMatrix() const 
	{ return m_mWorld; }

	// オブジェクトが有効か
	inline virtual bool IsExpired() const 
	{ return m_isExpired; }

	// 当たり判定
	bool Intersects(const Collider::SphereInfo& target, std::list<Collider::CollisionResult>* pResults);
	bool Intersects(const Collider::RayInfo& target, std::list<Collider::CollisionResult>* pResults);

	virtual void OnHit(){}

protected:
	// カメラからの距離
	float m_distCamera = 0.0f;

	// 存在消滅フラグ
	bool m_isExpired = false;

	// 行列
	Math::Matrix m_mWorld = Math::Matrix::Identity;

	// 当たり判定クラス
	std::unique_ptr<Collider> m_upCollider = nullptr;
};